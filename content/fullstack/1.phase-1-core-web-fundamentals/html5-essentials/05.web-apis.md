---
title: "HTML5 Web APIs"
description: "Master essential browser APIs: Geolocation, Web Storage, and History for interactive web applications"
difficulty: beginner
estimatedMinutes: 22
priority: essential
tags: ["html5", "web-apis", "geolocation", "local-storage", "session-storage", "history-api", "browser-apis"]
roadmap: fullstack
phase: 1
topic: html5-essentials
learningObjectives:
  - "Understand what Web APIs are and how they enhance web applications"
  - "Use the Geolocation API to get user location with permission"
  - "Store data locally with localStorage and sessionStorage"
  - "Manipulate browser history with the History API for single-page apps"
quiz:
  passingScore: 70
  questions:
    - question: "What is the difference between localStorage and sessionStorage?"
      type: single
      options:
        - "localStorage persists forever; sessionStorage clears when the tab closes"
        - "localStorage is faster than sessionStorage"
        - "sessionStorage has more storage space"
        - "There is no difference"
      correctAnswer: "localStorage persists forever; sessionStorage clears when the tab closes"
      explanation: "localStorage data persists even after the browser closes, until explicitly deleted. sessionStorage data is cleared when the browser tab closes. Both have the same storage capacity (5-10MB) and same API."

    - question: "Which methods are available for Web Storage (localStorage/sessionStorage)? Select all that apply."
      type: multiple
      options:
        - "setItem(key, value) - Store data"
        - "getItem(key) - Retrieve data"
        - "removeItem(key) - Delete data"
        - "clear() - Delete all data"
      correctAnswers:
        - "setItem(key, value) - Store data"
        - "getItem(key) - Retrieve data"
        - "removeItem(key) - Delete data"
        - "clear() - Delete all data"
      explanation: "All four methods are part of the Web Storage API. setItem stores data, getItem retrieves it, removeItem deletes a specific key, and clear() deletes all stored data."

    - question: "The Geolocation API automatically provides user location without asking for permission."
      type: true-false
      correctAnswer: false
      explanation: "False! The Geolocation API requires explicit user permission. Browsers show a permission prompt before sharing location data. Users can allow, deny, or dismiss the prompt."

    - question: "What does history.pushState() do?"
      type: single
      options:
        - "Adds a new entry to the browser history without reloading the page"
        - "Reloads the current page"
        - "Deletes browser history"
        - "Navigates back one page"
      correctAnswer: "Adds a new entry to the browser history without reloading the page"
      explanation: "pushState() adds a new history entry and updates the URL without causing a page reload. This is essential for single-page applications (SPAs) to maintain browser history while avoiding full page refreshes."

    - question: "How do you store an object in localStorage?"
      type: single
      options:
        - "localStorage.setItem('key', JSON.stringify(object))"
        - "localStorage.setItem('key', object)"
        - "localStorage.object = object"
        - "localStorage.push(object)"
      correctAnswer: "localStorage.setItem('key', JSON.stringify(object))"
      explanation: "localStorage only stores strings. To store objects or arrays, convert them to JSON strings using JSON.stringify(). When retrieving, use JSON.parse() to convert back to an object."

    - question: "Which method gets the user's current location in the Geolocation API?"
      type: single
      options:
        - "navigator.geolocation.getCurrentPosition()"
        - "navigator.getLocation()"
        - "geolocation.getUserPosition()"
        - "window.location.get()"
      correctAnswer: "navigator.geolocation.getCurrentPosition()"
      explanation: "navigator.geolocation.getCurrentPosition() requests the user's current position. It takes success and error callbacks as parameters and prompts the user for permission if not already granted."
---

# HTML5 Web APIs

HTML5 introduced powerful JavaScript APIs that let you access device features and browser capabilities. These APIs turn basic web pages into interactive applications that can get user location, store data locally, and manipulate browser history without page reloads.

In this lesson, you'll learn three essential Web APIs: **Geolocation** (get user location), **Web Storage** (save data locally), and **History API** (manage browser history for single-page apps).

## What Are Web APIs?

**Web APIs** are interfaces provided by the browser that let JavaScript interact with browser features and device hardware. They're built into modern browsers - no external libraries needed.

::illustration-checklist
---
title: Common HTML5 Web APIs
items:
  - text: Geolocation - Get user's location
    icon: üìç
  - text: Web Storage - Save data locally (localStorage/sessionStorage)
    icon: üíæ
  - text: History - Manipulate browser history
    icon: ‚èÆÔ∏è
  - text: Fetch - Make HTTP requests
    icon: üåê
  - text: Canvas - Draw graphics
    icon: üé®
  - text: Web Workers - Run scripts in background
    icon: ‚öôÔ∏è
note: These APIs work in all modern browsers without plugins
color: blue
---
::

## Geolocation API

The **Geolocation API** gets the user's physical location (latitude and longitude). It's used for maps, local recommendations, location-based services, and tracking.

### Basic Usage

```javascript
// Check if geolocation is supported
if ("geolocation" in navigator) {
  // Request current position
  navigator.geolocation.getCurrentPosition(
    // Success callback
    function(position) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;
      console.log(`Your location: ${lat}, ${lon}`);
    },
    // Error callback
    function(error) {
      console.error("Error getting location:", error.message);
    }
  );
} else {
  console.log("Geolocation not supported");
}
```

**User Permission:**
Browsers always ask for permission before sharing location. Users can allow, deny, or dismiss the prompt.

### Position Object

The success callback receives a `position` object with location data:

```javascript
navigator.geolocation.getCurrentPosition((position) => {
  console.log(position.coords.latitude);       // Latitude (e.g., 37.7749)
  console.log(position.coords.longitude);      // Longitude (e.g., -122.4194)
  console.log(position.coords.accuracy);       // Accuracy in meters
  console.log(position.coords.altitude);       // Altitude (meters, may be null)
  console.log(position.coords.altitudeAccuracy); // Altitude accuracy
  console.log(position.coords.heading);        // Direction (degrees, may be null)
  console.log(position.coords.speed);          // Speed (meters/sec, may be null)
  console.log(position.timestamp);             // Timestamp (milliseconds)
});
```

### Error Handling

The error callback receives an error object:

```javascript
navigator.geolocation.getCurrentPosition(
  (position) => {
    // Success
    console.log("Location:", position.coords);
  },
  (error) => {
    switch(error.code) {
      case error.PERMISSION_DENIED:
        console.log("User denied permission");
        break;
      case error.POSITION_UNAVAILABLE:
        console.log("Location unavailable");
        break;
      case error.TIMEOUT:
        console.log("Request timed out");
        break;
      default:
        console.log("Unknown error");
    }
  }
);
```

### Options

You can pass options to control behavior:

```javascript
const options = {
  enableHighAccuracy: true,  // Use GPS if available (slower, more accurate)
  timeout: 10000,            // Max wait time (milliseconds)
  maximumAge: 0              // Max age of cached position (0 = always fresh)
};

navigator.geolocation.getCurrentPosition(
  successCallback,
  errorCallback,
  options
);
```

### Watching Position (Live Tracking)

Use `watchPosition()` to get updates when the user moves:

```javascript
const watchId = navigator.geolocation.watchPosition(
  (position) => {
    console.log("New position:", position.coords.latitude, position.coords.longitude);
    // Update map marker, etc.
  },
  (error) => {
    console.error("Error:", error.message);
  },
  { enableHighAccuracy: true }
);

// Stop watching later
navigator.geolocation.clearWatch(watchId);
```

### Complete Geolocation Example

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Geolocation Demo</title>
</head>
<body>
  <h1>Geolocation Demo</h1>
  <button id="getLocation">Get My Location</button>
  <div id="result"></div>

  <script>
    document.getElementById('getLocation').addEventListener('click', () => {
      const resultDiv = document.getElementById('result');

      if (!navigator.geolocation) {
        resultDiv.textContent = "Geolocation not supported";
        return;
      }

      resultDiv.textContent = "Getting location...";

      navigator.geolocation.getCurrentPosition(
        (position) => {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;
          const accuracy = position.coords.accuracy;

          resultDiv.innerHTML = `
            <p><strong>Latitude:</strong> ${lat}</p>
            <p><strong>Longitude:</strong> ${lon}</p>
            <p><strong>Accuracy:</strong> ${accuracy} meters</p>
            <p><a href="https://www.google.com/maps?q=${lat},${lon}" target="_blank">
              View on Google Maps
            </a></p>
          `;
        },
        (error) => {
          resultDiv.textContent = `Error: ${error.message}`;
        },
        { enableHighAccuracy: true, timeout: 10000 }
      );
    });
  </script>
</body>
</html>
```

## Web Storage API

The **Web Storage API** provides two mechanisms to store data locally in the browser: `localStorage` and `sessionStorage`.

### localStorage vs. sessionStorage

| Feature | localStorage | sessionStorage |
|---------|--------------|----------------|
| **Lifespan** | Persists forever (until deleted) | Clears when tab closes |
| **Scope** | Shared across all tabs/windows | Specific to one tab |
| **Capacity** | 5-10MB per domain | 5-10MB per domain |
| **Use Cases** | User preferences, saved data | Temporary session data, form drafts |

### Basic Operations

Both APIs have the same methods:

```javascript
// Store data
localStorage.setItem('username', 'john_doe');

// Retrieve data
const username = localStorage.getItem('username');
console.log(username); // Output: john_doe

// Remove data
localStorage.removeItem('username');

// Clear all data
localStorage.clear();

// Check if key exists
if (localStorage.getItem('username') !== null) {
  console.log('Username exists');
}

// Get number of items
console.log(localStorage.length);

// Get key by index
const firstKey = localStorage.key(0);
```

### Alternative Syntax (Not Recommended)

You can also use dot or bracket notation, but `setItem/getItem` is clearer:

```javascript
// These work but are less explicit
localStorage.username = 'john_doe';
localStorage['username'] = 'john_doe';

const username = localStorage.username;
const username = localStorage['username'];
```

### Storing Objects and Arrays

`localStorage` only stores strings. Convert objects/arrays to JSON:

```javascript
// Storing an object
const user = {
  name: 'John Doe',
  email: 'john@example.com',
  age: 30
};

localStorage.setItem('user', JSON.stringify(user));

// Retrieving an object
const storedUser = JSON.parse(localStorage.getItem('user'));
console.log(storedUser.name); // Output: John Doe

// Storing an array
const todos = ['Buy milk', 'Write code', 'Exercise'];
localStorage.setItem('todos', JSON.stringify(todos));

// Retrieving an array
const storedTodos = JSON.parse(localStorage.getItem('todos'));
console.log(storedTodos[0]); // Output: Buy milk
```

### Handling Missing Data

Always check if data exists before parsing:

```javascript
const userJson = localStorage.getItem('user');

if (userJson) {
  const user = JSON.parse(userJson);
  console.log(user.name);
} else {
  console.log('No user data found');
}
```

### Complete localStorage Example

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>localStorage Demo</title>
</head>
<body>
  <h1>User Preferences</h1>

  <label>
    Theme:
    <select id="theme">
      <option value="light">Light</option>
      <option value="dark">Dark</option>
    </select>
  </label>

  <label>
    <input type="checkbox" id="notifications"> Enable notifications
  </label>

  <button id="save">Save Preferences</button>
  <button id="clear">Clear Preferences</button>

  <div id="status"></div>

  <script>
    // Load saved preferences on page load
    window.addEventListener('load', () => {
      const theme = localStorage.getItem('theme');
      const notifications = localStorage.getItem('notifications');

      if (theme) {
        document.getElementById('theme').value = theme;
        document.body.className = theme; // Apply theme
      }

      if (notifications === 'true') {
        document.getElementById('notifications').checked = true;
      }
    });

    // Save preferences
    document.getElementById('save').addEventListener('click', () => {
      const theme = document.getElementById('theme').value;
      const notifications = document.getElementById('notifications').checked;

      localStorage.setItem('theme', theme);
      localStorage.setItem('notifications', notifications);

      document.body.className = theme; // Apply theme immediately
      document.getElementById('status').textContent = 'Preferences saved!';
    });

    // Clear preferences
    document.getElementById('clear').addEventListener('click', () => {
      localStorage.clear();
      document.getElementById('theme').value = 'light';
      document.getElementById('notifications').checked = false;
      document.body.className = '';
      document.getElementById('status').textContent = 'Preferences cleared!';
    });
  </script>
</body>
</html>
```

### sessionStorage Example

```javascript
// Form draft that clears when tab closes
document.getElementById('messageForm').addEventListener('input', (e) => {
  sessionStorage.setItem('messageDraft', e.target.value);
});

// Restore draft on page load
window.addEventListener('load', () => {
  const draft = sessionStorage.getItem('messageDraft');
  if (draft) {
    document.getElementById('message').value = draft;
  }
});

// Clear draft on submit
document.getElementById('messageForm').addEventListener('submit', (e) => {
  e.preventDefault();
  // Send message...
  sessionStorage.removeItem('messageDraft');
});
```

### Storage Events

Listen for changes to localStorage from other tabs/windows:

```javascript
window.addEventListener('storage', (event) => {
  console.log('Storage changed:');
  console.log('Key:', event.key);
  console.log('Old Value:', event.oldValue);
  console.log('New Value:', event.newValue);
  console.log('URL:', event.url);

  // Update UI if relevant data changed
  if (event.key === 'theme') {
    document.body.className = event.newValue;
  }
});
```

**Note:** The `storage` event only fires in **other** tabs/windows, not the one that made the change.

## History API

The **History API** lets you manipulate the browser's history without page reloads. This is essential for single-page applications (SPAs) like React, Vue, and Angular apps.

### Basic Methods

```javascript
// Navigate back
history.back();      // Same as clicking browser back button
history.go(-1);      // Same as back()

// Navigate forward
history.forward();   // Same as clicking browser forward button
history.go(1);       // Same as forward()

// Navigate by multiple steps
history.go(-2);      // Back 2 pages
history.go(2);       // Forward 2 pages

// Current history length
console.log(history.length); // Number of entries
```

### pushState() - Add History Entry

`pushState()` adds a new entry to history without reloading the page:

```javascript
// Syntax: pushState(state, title, url)
history.pushState(
  { page: 'about' },     // State object (any data you want)
  'About Page',          // Title (most browsers ignore this)
  '/about'               // New URL (same origin only)
);
```

**What Happens:**
- URL changes to `/about`
- No page reload
- Browser back button now works
- `state` object is saved with this history entry

### replaceState() - Replace Current Entry

`replaceState()` modifies the current history entry without adding a new one:

```javascript
history.replaceState(
  { page: 'about', version: 2 },
  'About Page',
  '/about'
);
```

**Use Case:** Update URL or state without creating a new history entry (e.g., filtering search results).

### Handling Back/Forward Navigation

Listen for `popstate` events when users click back/forward:

```javascript
window.addEventListener('popstate', (event) => {
  console.log('Navigation detected');
  console.log('State:', event.state);

  // Load appropriate content based on state
  if (event.state && event.state.page) {
    loadPage(event.state.page);
  }
});
```

### Complete SPA Example

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SPA Demo</title>
  <style>
    nav a { margin-right: 10px; }
    #content { margin-top: 20px; padding: 20px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>Single Page App Demo</h1>

  <nav>
    <a href="/" data-page="home">Home</a>
    <a href="/about" data-page="about">About</a>
    <a href="/contact" data-page="contact">Contact</a>
  </nav>

  <div id="content"></div>

  <script>
    const content = document.getElementById('content');

    // Page content
    const pages = {
      home: '<h2>Home Page</h2><p>Welcome to the home page!</p>',
      about: '<h2>About Page</h2><p>Learn about us here.</p>',
      contact: '<h2>Contact Page</h2><p>Get in touch with us.</p>'
    };

    // Load page content
    function loadPage(page) {
      content.innerHTML = pages[page] || pages.home;
    }

    // Handle navigation clicks
    document.querySelectorAll('nav a').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();

        const page = link.dataset.page;
        const url = link.getAttribute('href');

        // Update content
        loadPage(page);

        // Add history entry
        history.pushState({ page }, '', url);
      });
    });

    // Handle back/forward navigation
    window.addEventListener('popstate', (event) => {
      const page = event.state ? event.state.page : 'home';
      loadPage(page);
    });

    // Load initial page
    loadPage('home');
  </script>
</body>
</html>
```

### URL Parameters with History API

```javascript
// Add query parameters
const params = new URLSearchParams({ sort: 'price', filter: 'electronics' });
history.pushState(null, '', `?${params.toString()}`);
// URL becomes: ?sort=price&filter=electronics

// Read query parameters
const urlParams = new URLSearchParams(window.location.search);
const sort = urlParams.get('sort');      // 'price'
const filter = urlParams.get('filter');  // 'electronics'
```

## Best Practices and Security

::illustration-checklist
---
title: Web APIs Best Practices
items:
  - text: Check browser support before using APIs
    icon: ‚úÖ
  - text: Never store sensitive data in localStorage (no passwords!)
    icon: üîí
  - text: Always handle errors for geolocation and storage quota
    icon: ‚ùó
  - text: Use sessionStorage for temporary session data
    icon: ‚è±Ô∏è
  - text: Update URL with pushState for better UX in SPAs
    icon: üîó
note: localStorage is not secure - avoid storing sensitive information
color: rose
---
::

## Common Mistakes to Avoid

1. **Storing sensitive data in localStorage**
   - localStorage is not encrypted and accessible via JavaScript
   - Never store passwords, tokens, or private information
   - Use secure, httpOnly cookies for sensitive data

2. **Forgetting to stringify/parse JSON**
   - localStorage only stores strings
   - Always use `JSON.stringify()` to store and `JSON.parse()` to retrieve objects

3. **Not checking for browser support**
   - Always check if the API exists before using it
   - Provide fallbacks for older browsers

4. **Exceeding storage quota**
   - localStorage has a 5-10MB limit
   - Wrap setItem in try/catch to handle quota errors

5. **Not handling geolocation errors**
   - Users can deny permission
   - Location may be unavailable
   - Always provide an error callback

## Key Takeaways

- **Geolocation API** gets user location with permission (latitude, longitude, accuracy)
- **localStorage** persists data forever; **sessionStorage** clears when tab closes
- Both storage APIs only store **strings** - use `JSON.stringify/parse` for objects
- **Never store sensitive data** in localStorage (it's not encrypted)
- **History API** manages browser history without page reloads (pushState, replaceState)
- **popstate event** fires when users navigate with back/forward buttons
- Always check browser support and handle errors gracefully
- Use `enableHighAccuracy: true` for GPS-level geolocation accuracy
- Storage events let tabs communicate changes to localStorage

These Web APIs are the building blocks of modern, interactive web applications. Master them to create rich user experiences without external libraries.

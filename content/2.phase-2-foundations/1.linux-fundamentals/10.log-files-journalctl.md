---
title: "Log Files and Journalctl"
description: "Learn to find and analyze Linux log files, use journalctl for systemd logs, and understand log rotation."
estimatedMinutes: 12
difficulty: beginner
learningObjectives:
  - "Navigate the /var/log directory and identify common log files"
  - "Use journalctl to query systemd logs effectively"
  - "Understand log rotation and the logrotate utility"
  - "Know the basics of centralized logging concepts"
quiz:
  passingScore: 70
  questions:
    - question: "Where are system log files typically stored in Linux?"
      type: single
      options:
        - "/etc/log/"
        - "/var/log/"
        - "/home/log/"
        - "/usr/log/"
      correctAnswer: "/var/log/"
      explanation: "The /var/log/ directory is the standard location for log files in Linux. It contains logs from the system, services, and applications."

    - question: "Which command shows only the last 100 lines of journal logs for nginx?"
      type: single
      options:
        - "journalctl nginx -100"
        - "journalctl -u nginx -n 100"
        - "journalctl --last 100 nginx"
        - "journalctl -f nginx"
      correctAnswer: "journalctl -u nginx -n 100"
      explanation: "The -u flag specifies the unit (service) and -n specifies the number of lines. So journalctl -u nginx -n 100 shows the last 100 log lines for nginx."

    - question: "Select all log files you might check when troubleshooting SSH login issues."
      type: multiple
      options:
        - "/var/log/auth.log"
        - "/var/log/secure"
        - "/var/log/nginx/access.log"
        - "/var/log/syslog"
      correctAnswers:
        - "/var/log/auth.log"
        - "/var/log/secure"
      explanation: "auth.log (Debian/Ubuntu) and secure (RHEL/CentOS) contain authentication logs including SSH. nginx logs are for web traffic. syslog has general messages but not typically SSH details."

    - question: "Log rotation prevents log files from filling up disk space."
      type: true-false
      correctAnswer: true
      explanation: "True. Logrotate compresses old logs and deletes very old ones, preventing logs from consuming all disk space. Without rotation, logs would grow indefinitely."

    - question: "What does the journalctl -f command do?"
      type: single
      options:
        - "Filters logs by priority"
        - "Formats logs as JSON"
        - "Follows new log entries in real-time"
        - "Finds specific text in logs"
      correctAnswer: "Follows new log entries in real-time"
      explanation: "The -f flag means 'follow' - it continuously shows new log entries as they are written, similar to 'tail -f' for regular files."
---

# Log Files and Journalctl

When something goes wrong, logs tell you what happened. Every service writes logs, and knowing where to find them and how to read them is essential for troubleshooting.

## Why Logs Matter in DevOps

Logs help you:

- Debug application errors
- Investigate security incidents
- Track system performance
- Audit user actions
- Understand what happened before a crash

## The /var/log Directory

Most traditional log files live in `/var/log/`:

```bash
ls /var/log/

auth.log        # Authentication logs (SSH, sudo)
syslog          # General system messages
kern.log        # Kernel messages
dpkg.log        # Package installation logs
nginx/          # Web server logs (directory)
mysql/          # Database logs (directory)
```

### Common Log Files

| Log File | Contents |
|----------|----------|
| `/var/log/syslog` | General system messages (Debian/Ubuntu) |
| `/var/log/messages` | General system messages (RHEL/CentOS) |
| `/var/log/auth.log` | Authentication logs (Debian/Ubuntu) |
| `/var/log/secure` | Authentication logs (RHEL/CentOS) |
| `/var/log/kern.log` | Kernel messages |
| `/var/log/dmesg` | Boot and hardware messages |
| `/var/log/nginx/access.log` | Web requests to nginx |
| `/var/log/nginx/error.log` | Nginx errors |

### Reading Log Files

```bash
# View entire log (not recommended for large files)
cat /var/log/syslog

# View last 50 lines
tail -n 50 /var/log/syslog

# Follow log in real-time
tail -f /var/log/syslog

# Search for errors
grep -i error /var/log/syslog

# Search for specific service
grep sshd /var/log/auth.log
```

## Journalctl: The Modern Way

On systems with systemd, `journalctl` provides powerful log querying. It accesses the systemd journal, which collects logs from all services.

### Basic Usage

```bash
# View all logs (oldest first)
journalctl

# View all logs (newest first)
journalctl -r

# Follow new entries in real-time
journalctl -f
```

### Filtering by Service

```bash
# Logs for a specific service
journalctl -u nginx

# Multiple services
journalctl -u nginx -u php-fpm

# Follow specific service
journalctl -u nginx -f
```

### Filtering by Time

```bash
# Since last boot
journalctl -b

# Previous boot
journalctl -b -1

# Since specific time
journalctl --since "2024-01-15 10:00"

# Last hour
journalctl --since "1 hour ago"

# Time range
journalctl --since "2024-01-15" --until "2024-01-16"

# Today's logs
journalctl --since today
```

### Filtering by Priority

::illustration-linear-flow
---
steps:
  - label: emerg
    sublabel: "0"
    icon: "\U0001F6A8"
    color: rose
  - label: alert
    sublabel: "1"
    icon: "\U000026A0\uFE0F"
    color: rose
  - label: crit
    sublabel: "2"
    icon: "\U00002757"
    color: rose
  - label: err
    sublabel: "3"
    icon: "\U0000274C"
    color: amber
  - label: warning
    sublabel: "4"
    icon: "\U000026A0\uFE0F"
    color: amber
  - label: notice
    sublabel: "5"
    icon: "\U0001F4AC"
    color: blue
  - label: info
    sublabel: "6"
    icon: "\U00002139\uFE0F"
    color: cyan
  - label: debug
    sublabel: "7"
    icon: "\U0001F41B"
    color: gray
direction: horizontal
size: full
---
::

```bash
# Show only errors and above
journalctl -p err

# Show warnings and above
journalctl -p warning

# Show only critical messages
journalctl -p crit
```

### Useful Options

```bash
# Show last N lines
journalctl -n 100

# Show output without paging
journalctl --no-pager

# Output as JSON
journalctl -o json-pretty

# Show kernel messages
journalctl -k

# Show messages from specific PID
journalctl _PID=1234
```

::illustration-checklist
---
title: Essential journalctl Commands
items:
  - text: "journalctl -u service    Filter by service"
    icon: "\U0001F3AF"
  - text: "journalctl -f            Follow in real-time"
    icon: "\U0001F4F1"
  - text: "journalctl -p err        Filter by priority"
    icon: "\U000026A0\uFE0F"
  - text: "journalctl --since       Filter by time"
    icon: "\U000023F0"
  - text: "journalctl -b            Current boot only"
    icon: "\U0001F504"
note: Combine flags for precise filtering
color: cyan
size: 2xl
---
::

## Log Rotation

Without management, logs grow forever and fill your disk. Log rotation solves this.

### How Logrotate Works

The `logrotate` utility:
1. Renames current log (e.g., `syslog` becomes `syslog.1`)
2. Creates a new empty log file
3. Compresses old logs (e.g., `syslog.1.gz`)
4. Deletes very old logs

### Logrotate Configuration

Main config: `/etc/logrotate.conf`
Per-application configs: `/etc/logrotate.d/`

```bash
# View nginx log rotation config
cat /etc/logrotate.d/nginx

/var/log/nginx/*.log {
    daily
    missingok
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 www-data adm
    sharedscripts
    postrotate
        systemctl reload nginx > /dev/null
    endscript
}
```

Key options:
- `daily/weekly/monthly` - Rotation frequency
- `rotate 14` - Keep 14 old versions
- `compress` - Gzip old logs
- `delaycompress` - Wait one rotation before compressing

### Manual Rotation

```bash
# Force log rotation
sudo logrotate -f /etc/logrotate.conf

# Test rotation (dry run)
sudo logrotate -d /etc/logrotate.conf
```

## Viewing Kernel Messages: dmesg

The `dmesg` command shows kernel ring buffer messages - hardware detection, driver loading, and kernel errors.

```bash
# View kernel messages
dmesg

# Follow new messages
dmesg -w

# Show human-readable timestamps
dmesg -T

# Show only errors
dmesg --level=err

# Clear the buffer (as root)
sudo dmesg -c
```

Use `dmesg` when troubleshooting:
- Hardware issues
- Driver problems
- Boot problems
- USB device detection

## Centralized Logging

In DevOps, you often need logs from many servers in one place. This is centralized logging.

### Why Centralize?

- Search logs across all servers at once
- Keep logs if a server fails
- Analyze patterns across systems
- Meet compliance requirements

### Common Solutions

| Tool | Description |
|------|-------------|
| **ELK Stack** | Elasticsearch, Logstash, Kibana |
| **Grafana Loki** | Like Prometheus but for logs |
| **Splunk** | Commercial log management |
| **AWS CloudWatch** | AWS native logging |
| **Fluentd** | Log collector and forwarder |

You will learn more about these in the Monitoring phase.

## Practical Examples

### Investigating SSH Failed Logins

```bash
# Debian/Ubuntu
grep "Failed password" /var/log/auth.log

# RHEL/CentOS
grep "Failed password" /var/log/secure

# Using journalctl
journalctl -u sshd | grep "Failed password"

# Count failed attempts by IP
grep "Failed password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -rn
```

### Finding Why a Service Failed

```bash
# Check service status
systemctl status nginx

# View recent logs
journalctl -u nginx -n 50

# View errors only
journalctl -u nginx -p err

# Follow logs while restarting
journalctl -u nginx -f &
sudo systemctl restart nginx
```

### Checking What Happened at a Specific Time

```bash
# Find events around 3 AM
journalctl --since "03:00" --until "03:30"

# Filter to errors during that time
journalctl --since "03:00" --until "03:30" -p err
```

### Monitoring Disk Space Used by Logs

```bash
# Check /var/log size
du -sh /var/log

# Find largest log files
du -ah /var/log | sort -rh | head -10
```

## Key Takeaways

- Logs live in `/var/log/` - know the common files like syslog, auth.log, kern.log
- `journalctl` is the modern way to query systemd logs
- Use `-u` for service, `-p` for priority, `--since` for time filtering
- `tail -f` and `journalctl -f` follow logs in real-time
- Logrotate prevents logs from filling your disk
- `dmesg` shows kernel and hardware messages
- Centralized logging collects logs from multiple servers

This completes the Linux Fundamentals section. You now have the foundation to work effectively on Linux systems. Next, you will learn Bash scripting to automate these tasks.

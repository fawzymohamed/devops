---
title: "System Services"
description: "Learn to manage system services with systemd and systemctl, including starting, stopping, and enabling services."
estimatedMinutes: 12
difficulty: beginner
learningObjectives:
  - "Understand what systemd is and how it manages services"
  - "Use systemctl to start, stop, restart, and check service status"
  - "Enable and disable services to control startup behavior"
  - "Read service logs with journalctl"
quiz:
  passingScore: 70
  questions:
    - question: "What command starts the nginx service immediately?"
      type: single
      options:
        - "systemctl enable nginx"
        - "systemctl start nginx"
        - "systemctl restart nginx"
        - "systemctl status nginx"
      correctAnswer: "systemctl start nginx"
      explanation: "systemctl start immediately starts a service. enable makes it start at boot but doesn't start it now. restart stops and starts it. status shows information."

    - question: "What is the difference between 'enable' and 'start' in systemctl?"
      type: single
      options:
        - "They do the same thing"
        - "enable starts now, start starts at boot"
        - "start starts now, enable starts at boot"
        - "enable is for root, start is for users"
      correctAnswer: "start starts now, enable starts at boot"
      explanation: "start immediately starts a service. enable configures it to start automatically at boot. You usually want both: enable --now does both at once."

    - question: "Select all valid systemctl commands."
      type: multiple
      options:
        - "systemctl status nginx"
        - "systemctl reload nginx"
        - "systemctl enable --now nginx"
        - "systemctl install nginx"
      correctAnswers:
        - "systemctl status nginx"
        - "systemctl reload nginx"
        - "systemctl enable --now nginx"
      explanation: "status, reload, and enable --now are valid systemctl commands. There is no 'systemctl install' - use package managers to install software."

    - question: "Service unit files are typically stored in /etc/systemd/system/ directory."
      type: true-false
      correctAnswer: true
      explanation: "True. Custom and admin-created service files go in /etc/systemd/system/. Package-installed services go in /lib/systemd/system/. The /etc/ location has higher priority."

    - question: "Which command shows logs for a specific service?"
      type: single
      options:
        - "systemctl logs nginx"
        - "journalctl -u nginx"
        - "cat /var/log/nginx"
        - "dmesg nginx"
      correctAnswer: "journalctl -u nginx"
      explanation: "journalctl -u nginx shows logs for the nginx unit (service). The -u flag filters by unit name. journalctl is the tool for reading systemd logs."
---

# System Services

Services (also called daemons) are programs that run in the background. Web servers, databases, and monitoring agents are all services. On modern Linux systems, **systemd** manages these services.

## What is systemd?

systemd is an init system and service manager. It:

- Starts services during boot
- Manages service dependencies
- Restarts services that crash
- Collects service logs
- Handles system targets (runlevels)

When your Linux system boots, systemd is one of the first processes (PID 1). It then starts all other services.

## The systemctl Command

`systemctl` is your main tool for managing services.

### Checking Service Status

```bash
# See status of a service
sudo systemctl status nginx

# Example output
● nginx.service - A high performance web server
     Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)
     Active: active (running) since Mon 2024-01-15 10:30:00 UTC; 2h ago
   Main PID: 1234 (nginx)
      Tasks: 2 (limit: 4915)
     Memory: 5.3M
     CGroup: /system.slice/nginx.service
             ├─1234 nginx: master process
             └─1235 nginx: worker process
```

Key information:
- **Loaded**: Service file location and whether it's enabled at boot
- **Active**: Current state (running, inactive, failed)
- **Main PID**: Process ID of the main service process
- **Memory/Tasks**: Resource usage

### Starting and Stopping Services

```bash
# Start a service
sudo systemctl start nginx

# Stop a service
sudo systemctl stop nginx

# Restart a service (stop + start)
sudo systemctl restart nginx

# Reload configuration without full restart
sudo systemctl reload nginx

# Restart only if already running
sudo systemctl try-restart nginx
```

::illustration-linear-flow
---
steps:
  - label: stop
    sublabel: Service stops
    icon: "\U000023F9\uFE0F"
    color: rose
  - label: start
    sublabel: Service starts
    icon: "\U000025B6\uFE0F"
    color: emerald
  - label: restart
    sublabel: stop + start
    icon: "\U0001F504"
    color: amber
  - label: reload
    sublabel: Config reload
    icon: "\U0001F4C4"
    color: blue
direction: horizontal
size: full
---
::

### Boot Behavior: Enable and Disable

```bash
# Enable service to start at boot
sudo systemctl enable nginx

# Disable service from starting at boot
sudo systemctl disable nginx

# Enable AND start immediately
sudo systemctl enable --now nginx

# Disable AND stop immediately
sudo systemctl disable --now nginx
```

### Checking States

```bash
# Check if service is active
systemctl is-active nginx

# Check if service is enabled
systemctl is-enabled nginx

# Check if service has failed
systemctl is-failed nginx
```

## Listing Services

```bash
# List all services
systemctl list-units --type=service

# List running services
systemctl list-units --type=service --state=running

# List enabled services
systemctl list-unit-files --type=service --state=enabled

# List failed services
systemctl --failed
```

## Service Unit Files

Services are defined in unit files. These are configuration files that tell systemd how to run a service.

### Unit File Locations

| Location | Purpose |
|----------|---------|
| `/lib/systemd/system/` | Package-installed services |
| `/etc/systemd/system/` | Admin-created services (higher priority) |
| `/run/systemd/system/` | Runtime-generated units |

### Viewing a Unit File

```bash
# View the unit file content
systemctl cat nginx

# See where unit file is located
systemctl show -p FragmentPath nginx
```

### Example Unit File

```ini
[Unit]
Description=A high performance web server
After=network.target

[Service]
Type=forking
ExecStart=/usr/sbin/nginx
ExecReload=/bin/kill -s HUP $MAINPID
ExecStop=/bin/kill -s QUIT $MAINPID
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

Key sections:
- **[Unit]**: Description and dependencies
- **[Service]**: How to start, stop, restart
- **[Install]**: When this service should start

### Creating a Custom Service

```bash
# Create a new service file
sudo nano /etc/systemd/system/myapp.service
```

```ini
[Unit]
Description=My Application
After=network.target

[Service]
Type=simple
User=myapp
WorkingDirectory=/opt/myapp
ExecStart=/opt/myapp/bin/start.sh
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

```bash
# Reload systemd to recognize new service
sudo systemctl daemon-reload

# Start and enable the service
sudo systemctl enable --now myapp
```

## Reading Logs with journalctl

systemd collects logs from all services. Use `journalctl` to read them.

### Basic journalctl Usage

```bash
# View all logs
journalctl

# View logs for a specific service
journalctl -u nginx

# Follow logs in real-time
journalctl -u nginx -f

# Show recent logs (last 50 lines)
journalctl -u nginx -n 50

# Show logs since boot
journalctl -b

# Show logs since a time
journalctl --since "2024-01-15 10:00"
journalctl --since "1 hour ago"
```

::illustration-checklist
---
title: Useful journalctl Options
items:
  - text: "-u service    Show logs for specific service"
    icon: "\U0001F3AF"
  - text: "-f           Follow log output in real-time"
    icon: "\U0001F4F1"
  - text: "-n 100       Show last 100 lines"
    icon: "\U0001F522"
  - text: "-p err       Filter by priority (err, warning, etc.)"
    icon: "\U000026A0\uFE0F"
  - text: "--since      Filter by time"
    icon: "\U000023F0"
note: Combine options like journalctl -u nginx -f -n 50
color: cyan
size: 2xl
---
::

### Log Priority Levels

```bash
# Show only errors
journalctl -p err

# Show errors and warnings
journalctl -p warning

# Priority levels: emerg, alert, crit, err, warning, notice, info, debug
```

## System Targets

Targets are groups of services that define system states. They replaced the old runlevel concept.

| Target | Description |
|--------|-------------|
| `poweroff.target` | System shutdown |
| `rescue.target` | Single-user mode |
| `multi-user.target` | Multi-user, no GUI |
| `graphical.target` | Multi-user with GUI |

```bash
# See current target
systemctl get-default

# Set default target
sudo systemctl set-default multi-user.target

# Switch target immediately
sudo systemctl isolate rescue.target
```

## Practical Examples

### Setting Up nginx to Start at Boot

```bash
# Install nginx
sudo apt install nginx

# Enable and start
sudo systemctl enable --now nginx

# Verify
systemctl status nginx
curl localhost
```

### Troubleshooting a Failed Service

```bash
# Check status for error messages
systemctl status failing-service

# Check detailed logs
journalctl -u failing-service -n 100

# Check for configuration errors
sudo nginx -t    # For nginx specifically

# Try starting and watch logs
sudo systemctl start failing-service
journalctl -u failing-service -f
```

### Restarting a Service After Config Change

```bash
# Edit configuration
sudo nano /etc/nginx/nginx.conf

# Test configuration
sudo nginx -t

# Reload (preferred - no downtime)
sudo systemctl reload nginx

# Or restart if reload doesn't work
sudo systemctl restart nginx
```

## Key Takeaways

- systemd manages services on modern Linux systems
- `systemctl start/stop/restart/status` controls services
- `enable` makes services start at boot; `start` runs them now
- `enable --now` does both at once
- Service definitions are in unit files (`.service` files)
- `journalctl -u service` shows logs for a specific service
- Always run `daemon-reload` after creating or modifying unit files

In the next lesson, you will learn about scheduling tasks with cron jobs.

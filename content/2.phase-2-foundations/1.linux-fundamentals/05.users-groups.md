---
title: "Users and Groups"
description: "Learn how to manage Linux users and groups, including creating accounts and using sudo for elevated privileges."
estimatedMinutes: 12
difficulty: beginner
learningObjectives:
  - "Understand how Linux stores user and group information"
  - "Create and modify user accounts with useradd and usermod"
  - "Manage groups with groupadd and assign users to groups"
  - "Configure sudo access for administrative tasks"
quiz:
  passingScore: 70
  questions:
    - question: "Which file stores encrypted user passwords in modern Linux systems?"
      type: single
      options:
        - "/etc/passwd"
        - "/etc/shadow"
        - "/etc/group"
        - "/etc/users"
      correctAnswer: "/etc/shadow"
      explanation: "The /etc/shadow file stores encrypted passwords. Historically, /etc/passwd contained passwords, but they were moved to /etc/shadow for security since /etc/passwd must be readable by all users."

    - question: "What command creates a new user account along with their home directory?"
      type: single
      options:
        - "useradd -m username"
        - "usermod username"
        - "adduser username"
        - "passwd username"
      correctAnswer: "useradd -m username"
      explanation: "useradd -m creates a new user with a home directory. The -m flag ensures the home directory is created. usermod modifies existing users, and passwd sets passwords."

    - question: "Select all files that store user or group information."
      type: multiple
      options:
        - "/etc/passwd"
        - "/etc/shadow"
        - "/etc/group"
        - "/etc/hosts"
      correctAnswers:
        - "/etc/passwd"
        - "/etc/shadow"
        - "/etc/group"
      explanation: "/etc/passwd stores user account info, /etc/shadow stores passwords, and /etc/group stores group memberships. /etc/hosts maps hostnames to IP addresses - not user-related."

    - question: "Users can only belong to one group in Linux."
      type: true-false
      correctAnswer: false
      explanation: "False. Each user has one primary group but can belong to multiple secondary groups. Use the 'groups' command to see all groups a user belongs to."

    - question: "Which command grants a regular user the ability to run commands as root?"
      type: single
      options:
        - "usermod -g root"
        - "Adding user to sudoers file"
        - "chmod +s /bin/bash"
        - "chown root username"
      correctAnswer: "Adding user to sudoers file"
      explanation: "The sudoers file (edited with visudo) controls who can use sudo to run commands as root. Adding a user to the sudo group or sudoers file grants them administrative privileges."
---

# Users and Groups

Linux is a multi-user system. Every process runs as a user, and files belong to users and groups. Understanding user management is essential for system security and access control.

## Why This Matters in DevOps

As a DevOps engineer, you will:

- Create service accounts for applications
- Set up user access on servers
- Control who can run administrative commands
- Troubleshoot permission issues related to users and groups

## How Linux Stores User Information

Linux uses several text files to store user and group data.

### /etc/passwd - User Accounts

This file contains basic information about all users:

```bash
cat /etc/passwd | head -3

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
ahmed:x:1000:1000:Ahmed Ali:/home/ahmed:/bin/bash
```

Each line has seven fields separated by colons:

```
username:password:UID:GID:comment:home:shell
```

| Field | Example | Meaning |
|-------|---------|---------|
| username | ahmed | Login name |
| password | x | Password stored elsewhere (in /etc/shadow) |
| UID | 1000 | User ID number |
| GID | 1000 | Primary group ID |
| comment | Ahmed Ali | Full name or description |
| home | /home/ahmed | Home directory |
| shell | /bin/bash | Default shell |

### /etc/shadow - Passwords

Encrypted passwords and password policies live here. Only root can read this file:

```bash
sudo cat /etc/shadow | grep ahmed

ahmed:$6$xyz...:19200:0:99999:7:::
```

### /etc/group - Groups

Group definitions and memberships:

```bash
cat /etc/group | head -5

root:x:0:
daemon:x:1:
sudo:x:27:ahmed
developers:x:1001:ahmed,sara,ali
```

Format: `groupname:password:GID:members`

## Creating Users

### useradd - Create User

```bash
# Basic user creation
sudo useradd john

# Create user with home directory
sudo useradd -m john

# Create user with specific shell
sudo useradd -m -s /bin/bash john

# Create user with custom home directory
sudo useradd -m -d /home/custom john

# Create user and add to groups
sudo useradd -m -G sudo,developers john
```

::illustration-checklist
---
title: Common useradd Options
items:
  - text: "-m    Create home directory"
    icon: "\U0001F3E0"
  - text: "-s    Set default shell"
    icon: "\U0001F4BB"
  - text: "-G    Add to extra groups"
    icon: "\U0001F465"
  - text: "-d    Specify home directory path"
    icon: "\U0001F4C1"
  - text: "-c    Add comment/full name"
    icon: "\U0001F4DD"
note: Always use -m to create home directory
color: blue
size: 2xl
---
::

### passwd - Set Password

```bash
# Set password for user
sudo passwd john

# Force password change on next login
sudo passwd -e john
```

### Complete User Creation

```bash
# Create user with all common options
sudo useradd -m -s /bin/bash -c "John Developer" -G developers john
sudo passwd john
```

## Modifying Users

### usermod - Modify User

```bash
# Add user to a group
sudo usermod -aG docker john

# Change user's shell
sudo usermod -s /bin/zsh john

# Change username
sudo usermod -l newname oldname

# Lock user account
sudo usermod -L john

# Unlock user account
sudo usermod -U john
```

**Important:** Use `-aG` (append to groups), not just `-G`. Without `-a`, the user loses all other group memberships!

### Deleting Users

```bash
# Delete user (keep home directory)
sudo userdel john

# Delete user and home directory
sudo userdel -r john
```

## Managing Groups

### Creating Groups

```bash
# Create a new group
sudo groupadd developers

# Create group with specific GID
sudo groupadd -g 2000 webteam
```

### Adding Users to Groups

```bash
# Add user to group
sudo usermod -aG developers ahmed

# Or use gpasswd
sudo gpasswd -a ahmed developers

# Remove user from group
sudo gpasswd -d ahmed developers
```

### Viewing Group Membership

```bash
# See your groups
groups

# See another user's groups
groups john

# See group members
getent group developers
```

### Deleting Groups

```bash
sudo groupdel developers
```

## The sudo System

Regular users cannot perform administrative tasks. The `sudo` command lets authorized users run commands as root.

### How sudo Works

```bash
# Run command as root
sudo apt update

# Run command as different user
sudo -u postgres psql

# Open root shell
sudo -i
```

### The sudoers File

The `/etc/sudoers` file controls who can use sudo. **Never edit it directly** - use `visudo`:

```bash
sudo visudo
```

Common sudoers entries:

```bash
# User can run all commands
ahmed ALL=(ALL:ALL) ALL

# User can run specific commands without password
john ALL=(ALL) NOPASSWD: /usr/bin/systemctl restart nginx

# Group can run all commands
%developers ALL=(ALL:ALL) ALL
```

### Adding Users to sudo Group

The easiest way to give admin access:

```bash
# Add to sudo group (Debian/Ubuntu)
sudo usermod -aG sudo john

# Add to wheel group (RHEL/CentOS)
sudo usermod -aG wheel john
```

## Practical Examples

### Setting Up a New Developer

```bash
# Create user with home directory
sudo useradd -m -s /bin/bash -c "Sara Developer" sara

# Set password
sudo passwd sara

# Add to relevant groups
sudo usermod -aG developers,docker sara

# Verify
id sara
```

### Creating a Service Account

Service accounts run applications and usually cannot log in:

```bash
# Create system user without login
sudo useradd -r -s /usr/sbin/nologin myapp

# -r creates a system account (UID below 1000)
# nologin shell prevents interactive login
```

### Checking User Information

```bash
# View your user info
whoami
id

# View any user's info
id ahmed

# Example output
uid=1000(ahmed) gid=1000(ahmed) groups=1000(ahmed),27(sudo),998(docker)

# See currently logged-in users
who
w
```

## Common User Management Commands

| Command | Purpose |
|---------|---------|
| `useradd` | Create new user |
| `usermod` | Modify existing user |
| `userdel` | Delete user |
| `passwd` | Set/change password |
| `groupadd` | Create new group |
| `groupmod` | Modify group |
| `groupdel` | Delete group |
| `id` | Show user/group IDs |
| `groups` | Show group memberships |
| `whoami` | Show current username |

## Key Takeaways

- User info is in `/etc/passwd`, passwords in `/etc/shadow`, groups in `/etc/group`
- Use `useradd -m` to create users with home directories
- Always use `usermod -aG` (with -a) to add users to groups
- sudo allows regular users to run commands as root
- Edit sudoers only with `visudo` to prevent syntax errors
- Service accounts should use `/usr/sbin/nologin` as their shell

In the next lesson, you will learn about process management - viewing and controlling running programs.
